
@{
    ViewBag.Title = "abc";
}

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <script src="https://unpkg.com/read-excel-file@4.x/bundle/read-excel-file.min.js"></script>
</head>
<body>
    <section class="page-title-section overlay" data-background="images/backgrounds/page-title.jpg">
        <div class="container">
            <div class="row">
                <div class="col-md-8">
                    <ul class="list-inline custom-breadcrumb">
                        <li class="list-inline-item"><a class="h2 text-primary font-secondary" href="page-link">Adminstration Portal</a></li>
                        <li class="list-inline-item text-white h3 font-secondary"></li>
                    </ul>
                    <p class="text-lighten">Do you have other questions? Don't worry, there aren't any dumb questions. Just fill out the form below and we'll get back to you as soon as possible.</p>
                </div>
            </div>
        </div>
    </section>
    <section class="section bg-gray">
        <input type="file" id="input" value="~/Upload ProjectData/StudentAddmissionDetails/Lorem0a96ce/Loreme3c2ef/Lorem.xlsx">
        <table id="tbl-data"></table>
        <script>
            var input = document.getElementById('input');
            input.addEventListener('change', function () {
                readXlsxFile(input.files[0]).then(function (data) {
                    var i = 0;
                    data.map((row, index) => {
                        if (i == 0) {
                            let table = document.getElementById('tbl-data');
                            generateTableHead(table, row);
                        }

                        if (i > 0) {
                            let table = document.getElementById('tbl-data');
                            generateTableRows(table, row);
                        }
                        i++;
                    });
                });
            });
            function generateTableHead(table, data) {
                let thead = table.createTHead();
                let row = thead.insertRow();
                for (let key of data) {
                    let th = document.createElement('th');
                    let text = document.createTextNode(key);
                    th.appendChild(text);
                    row.appendChild(th);
                }
            }

            function generateTableRows(table, data) {
                let newRow = table.insertRow(-1);
                data.map((row, index) => {
                    let newCell = newRow.insertCell();
                    let newText = document.createTextNode(row);
                    newCell.appendChild(newText);
                });
            }
        </script>
    </section>
</body>
</html>
